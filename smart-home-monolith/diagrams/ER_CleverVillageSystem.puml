@startuml
entity "User" {
    *id: UUID4
    *username: varchar
    *first_name: varchar
    *last_name: varchar
    *password: varchar
    *created_at: datetime
}

entity "House" {
    *id: UUID4
    *created_at: datetime
    *address: varchar
    *square: integer
    *user_id: UUID4
}

entity "Module" {
    *id: UUID4
    *created_at: datetime
    *type: Heating || Watcher || Gates || etc.
}

entity "HouseModule" {
    *id: UUID4
    *house_id: UUID4
    *module_id: UUID4
}

entity "SensorModule" {
    *id: UUID4
    *module_id: UUID4
    *sensor_id: UUID4
}

entity "Device" {
    *id: UUID4
    *created_at: datetime
    *name: varchar
    *vendor_name: varchar
    *description: text
    *module_id: UUID4
}

entity "Sensor" {
    *id: UUID4
    *created_at: datetime
    *type: enum: Temperature || Moving || etc
}

entity "TelemetryData" {
    *id: UUID4
    *created_at: datetime
    *source_id: UUID4
    *source_type: enum: module || sensor
    *data: JSON
}

User ||--o{ House : "1:M"
House ||--o{ HouseModule : "M2M"
Module ||--o{ HouseModule : "M2M"
Module ||--o{ Device : "1:M"

Module ||--o{ SensorModule : "1:M"
Sensor ||--o{ SensorModule : "1:M"

SensorModule ||--o{ TelemetryData : "1:M"
HouseModule ||--o{ TelemetryData : "1:M"
@enduml
